<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<ui:composition template="/templates/modeloGeral.xhtml">
	<ui:define name="metadata">
		<f:metadata>
			<f:event listener="#{vendaBean.buscarVenda}" type="preRenderView" />
		</f:metadata>

	</ui:define>

	<ui:define name="conteudo">
		<h:form id="formListaVenda">
		
		<div align="center"
				style="text-align: center !important; margin-bottom: 10px;">
				<h2>Vendas</h2>
			</div>



			<h:panelGrid columns="7" style="margin-buttom: 10px;">
				<p:outputLabel value="Data Inicial: " />
				<p:calendar value="#{vendaBean.filtro.dataInicial}" />

				<p:outputLabel value="Data Final: " />
				<p:calendar value="#{vendaBean.filtro.dataFinal}" />

				<p:commandButton icon="ui-icon-search"
					actionListener="#{vendaBean.buscarVenda}"
					update=":msgInfo :formListaVenda:tblListaVenda" />


			</h:panelGrid>

			<p:dataTable id="tblListaVenda"
				emptyMessage="Nenhum registro encontrado."
				value="#{vendaBean.listaDeVendasFiltradas}" var="venda" rows="10"
				style="margin-bottom:20px" paginator="true"
				paginatorTemplate=" {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}" 
				rowsPerPageTemplate="5,10,15">


				<p:column headerText="CÃ³digo" class="centralizarTxtColuna"
					style="width:100px">
					<h:outputText value="#{venda.codigo}" />
				</p:column>

				<p:column headerText="Data" class="centralizarTxtColuna"
					style="width:300px">
					<h:outputText value="#{venda.data}">
						<f:convertDateTime pattern="dd/MM/yyyy" />
					</h:outputText>
				</p:column>

				<p:column headerText="Valor" class="centralizarTxtColuna"
					style="width:300px">
					<h:outputText value="#{venda.valor}">
						<f:convertNumber pattern="0.00" />
					</h:outputText>
				</p:column>

				<p:column headerText="Cliente" class="centralizarTxtColuna"
					style="width:300px">
					<h:outputText value="#{venda.cliente.nome}" />
				</p:column>

				<p:column headerText="Vendedor" class="centralizarTxtColuna"
					style="width:300px">
					<h:outputText value="#{venda.funcionario.nome}" />
				</p:column>

				<p:column headerText="OpÃ§Ãµes" class="centralizarTxtColuna"
					style="width: 80px">

					<p:commandButton style="color:#red;" icon="ui-icon-zoomin"
						title="Detalhes" oncomplete="PF('dlgDetalhesVenda').show();"
						update=":formListaVenda:tblVenda :formListaVenda:tblItens">
						<f:setPropertyActionListener target="#{vendaBean.venda }"
							value="#{venda}" />

					</p:commandButton>

				</p:column>

				<f:facet name="{Exporters}">
					<h:commandLink style="float: right;">
						<p:graphicImage library="images" name="/pdf1.png" width="24" />
						<p:dataExporter type="pdf" target="tblListaVenda" fileName="venda"
							encoding="ISO-8859-1" />
					</h:commandLink>

					<h:commandLink style="float: right;">
						<p:graphicImage library="images" name="/excel.png" width="24" />
						<p:dataExporter type="xls" target="tblListaVenda" fileName="venda" />
					</h:commandLink>
				</f:facet>


			</p:dataTable>


			<p:dialog widgetVar="dlgDetalhesVenda" closable="true"
				draggable="false" resizable="false" modal="true" appendTo="@(body)"
				style="margin-top: -50px;">

				<h:panelGrid columns="1">
					<h:outputText value="Detalhes da venda"
						styleClass=".ui-dialog.ui-widget-content .ui-dialog-titlebar"
						style="margin-left: 500px;font-family: sans-serif;font-weight: 500;font-size: 20px;" />
				</h:panelGrid>
				<h:panelGrid style="margin-top:10px;">
				</h:panelGrid>
				<p:dataTable id="tblVenda"
					emptyMessage="Nenhum registro encontrado."
					value="#{vendaBean.venda}" var="venda" style="width: 1200px;">
					<p:column headerText="CÃ³digo" class="centralizarTxtColuna"
						style="width:60px">
						<h:outputText value="#{venda.codigo}" />
					</p:column>

					<p:column headerText="Data" class="centralizarTxtColuna"
						style="width:200px">
						<h:outputText value="#{venda.data}">
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</h:outputText>
					</p:column>

					<p:column headerText="Valor Total" class="centralizarTxtColuna"
						style="width:200px">
						<h:outputText value="R$ #{venda.valor}">
							<f:convertNumber pattern="0.00" />
						</h:outputText>
					</p:column>

					<p:column headerText="Cliente" class="centralizarTxtColuna"
						style="width:300px">
						<h:outputText value="#{venda.cliente.nome}" />
					</p:column>

					<p:column headerText="Vendedor" class="centralizarTxtColuna"
						style="width:300px">
						<h:outputText value="#{venda.funcionario.nome}" />
					</p:column>
				</p:dataTable>

				<h:panelGrid style="margin-top:30px;">
				</h:panelGrid>

				<h:panelGrid columns="1">
					<h:outputText value="Itens da venda"
						styleClass=".ui-dialog.ui-widget-content .ui-dialog-titlebar"
						style="margin-left: 520px;
	    font-family: sans-serif;
    font-weight: 500;
    font-size: 20px;" />
				</h:panelGrid>
				<h:panelGrid style="margin-top:10px;">
				</h:panelGrid>
				<p:dataTable id="tblItens"
					emptyMessage="Nenhum registro encontrado."
					value="#{vendaBean.venda.itensDaVenda}" var="itemVenda"
					style="width: 1200px;" scrollable="true" scrollHeight="150">
					<p:column headerText="Produto">
						<h:outputText value="#{itemVenda.produto.descricao}"
							style="text-align:center" />
					</p:column>

					<p:column headerText="Quantidade ">
						<h:outputText value="#{itemVenda.quantidade} "
							style="text-align:center" />
					</p:column>

					<p:column headerText="Valor ">
						<h:outputText value="R$ #{itemVenda.valor}"
							style="text-align:center">
							<f:convertNumber pattern="0.00" />
						</h:outputText>
					</p:column>

				</p:dataTable>

				<h:panelGrid style="margin-top:30px;">
				</h:panelGrid>
			</p:dialog>


		</h:form>












	</ui:define>
</ui:composition>
</html>
